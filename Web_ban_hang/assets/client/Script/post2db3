function checkboxChange(){$(".grp_property .checkbox input:checkbox").on("change",function(){$(this).is(":checked")?($(this).next().addClass("active"),$("#hddProperty"+$(this).attr("group")).val($(this).attr("value"))):($(this).next().removeClass("active"),$("#hddProperty"+$(this).attr("group")).val("0"))})}function loadData(){var t=$("#hddAreaId_nl").val(),n;t.length>0&&$("#div_area_nl #"+(t=="City_0"?"City_All":t)).trigger("click");n=$("#hddCateId_nl").val();n>0&&($("#div_cate_nl .sub-category #"+n).addClass("active").parents(".sub-category").parent().addClass("expand"),$("#div_cate_nl #label_cate").text($("#div_cate_nl .sub-category #"+n).text()),GetPropertyGroup(n))}function GetPropertyGroup(n){var t=$("#hddProperty1").val();$("body").data("GetPropertyGroup_"+n)!=null?(dataProperty=$("body").data("GetPropertyGroup_"+n),GenerateHtmlProperty(dataProperty)):$.ajax({type:"POST",cache:!1,url:"/HandlerWeb/SearchHandler.ashx?module=GetPropertyGroup",data:{cateId:n,pId:t},success:function(t){dataProperty=$.parseJSON(t);$("body").data("GetPropertyGroup_"+n,dataProperty)},timeout:5e3,complete:function(){GenerateHtmlProperty(dataProperty)}})}function GenerateHtmlProperty(n){var t="",f="",u=0,o=0,i=0,r=!1,s=!1,e=!1;n!=null&&(i=n.length,$.each(n,function(t,r){if(r.Parent.GroupId>1&&($.each(r.SubMenu,function(n,t){t.PropertyGroup>0&&(i=i+1)}),n.length<i))return i=i-1,!1}),u=getParentPropertyId(n),t+='<div class="col-gr-50per">',$.each(n,function(n,h){var c="",l="",a;r=!1;a=n;$.each(h.SubMenu,function(n,t){var v,o;if(t.PropertyGroup==0){if(t.ParrentPropertyId==0)if(t.Group==1&&r||t.Group==1&&t.PropertyAlias!=null&&t.PropertyAlias.indexOf("khac")==-1&&CheckCateHasModel(t.CateId))r=!0,f+=u==t.PropertyId?'<option value="'+t.PropertyId+'" selected="selected">'+t.PropertyName+"<\/option>":'<option value="'+t.PropertyId+'">'+t.PropertyName+"<\/option>";else{if(h.Parent.IsInputText)return!1;v="";c+='<li class="lv1">';$("#hddProperty"+t.Group).val()==t.PropertyId&&(l=t.PropertyName,v='class="active"');c+='<span id="cb_'+t.PropertyId+'" rel="'+t.PropertyId+'" name="rd'+t.Group+'" '+v+">"+t.PropertyName+"<\/span>";c+="<\/li>"}}else h.Parent.UnitId=-1,s=!0,t.ParrentPropertyId==0&&(o=$("#hddProperty"+t.Group).val()==t.PropertyId,c+='<div class="lst_item">',c+='   <div class="form-tit titlebox" title="'+t.PropertyName+'">'+t.PropertyName+"<\/div>",c+='   <div class="form-cont">',c+='       <div class="group-action dropdown-select" id="group'+t.Group+'">',c+='           <span class="btn"><span id="label_group'+t.Group+'">'+(o?"Có":"Không")+'<\/span><i class="icon-down-dir"><\/i><\/span>',c+='           <ul class="dropdown-menu group-category">',c+='               <li><a class="checkPost defaultvalue'+(o?"":" active")+'" href="javascript:;" group="'+t.Group+'" value="0">Không<\/a><\/li>',c+='               <li><a class="checkPost'+(o?" active":"")+'" href="javascript:;" group="'+t.Group+'" value="'+t.PropertyId+'">Có<\/a><\/li>',c+="           <\/ul>",c+="       <\/div>",c+="   <\/div>",c+="<\/div>",a++,!e&&i>0&&a==Math.round(i/2)&&(c+='<\/div><div class="col-gr-50per">',e=!0))});r&&i--;h.Parent.GroupId==1&&r?(t+='<div id="wr_hsxPost" class="lst_item"><span class="titlebox post_hsx_'+h.Parent.GroupId+'">'+h.Parent.Name+'<span class="request requiredGroup1"> *<\/span><\/span>',t+='<div class="wr_select"><select id="hsxPost">',t+='<option value="0" selected="selected">-- Chọn hãng sản xuất --<\/option>',t+=f,t+="<\/select>",t+="<\/div><\/div>",t+='<div id="wr_modelPost" class="lst_item"><span class="titlebox post_model_'+h.Parent.GroupId+'">Model<span class="request rq_model"> *<\/span><\/span>',t+='<div class="wr_select"><select id="modelPost">',t+='<option value="0" selected="selected">-- Chọn Model --<\/option>',t+="<\/select>",t+="<\/div><\/div>",o=1):h.Parent.UnitId==-1?t+=c:(t+='<div class="lst_item"><span class="titlebox">'+h.Parent.Name+(h.Parent.GroupId==1?'<span class="request requiredGroup1"> *<\/span>':"")+'<\/span><ul class="wr_group">',t+='<li id="group_'+h.Parent.GroupId+'" class="single sbHolder mnone">',t+=l==""?'<span class="lbProperty icon-down">-- Chọn '+h.Parent.Name+" --<\/span>":'<span class="lbProperty icon-down">'+l+"<\/span>",t+='<ul class="mparent">',t+=c,t+="<\/ul><\/li>",t+="<\/ul><\/div>");!e&&i>0&&n+1==Math.round(i/2)&&(t+='<\/div><div class="col-gr-50per">')}),t+="<\/div>");$("#box_property").html("");t!=""?($(".wrbox_property").show(),$("#box_property").append(t),u>0?bindModel(u,dataProperty):$("#modelPost").combobox({}),combobox_click(),single_click(),checkbox_click()):$(".wrbox_property").hide();$("#hddScrollTo").val()==1&&$(".validation-summary-errors").length>0&&$(window).scrollTop($("#info_user").offset().top-100)}function getParentPropertyId(n){var t=$("#hddProperty1").val();return t>0&&$.each(n[0].SubMenu,function(n,i){if(i.ParrentPropertyId==t||i.PropertyId==t)return t=i.ParrentPropertyId>0?i.ParrentPropertyId:i.PropertyId,!1}),t}function checkSubMenu(n,t){var i=!1;return $.each(n,function(n,r){if(r.ParrentPropertyId==t)return i=!0,!1}),i}function CheckCateHasModel(n){return",2,3,5,7,11,12,20, 42,43,47,97,100,".indexOf(","+n+",")!=-1?!0:!1}function GenerateModel(n){var t=null,i=$("#hddCateId_nl").val();$("body").data("GetPropertyModel_"+i+"_"+n)!=null&&(t=$("body").data("GetPropertyModel_"+i+"_"+n));t==null?$.ajax({type:"POST",cache:!1,url:"/HandlerWeb/SearchHandler.ashx?module=GetPropertyGroup",data:{cateId:i,pId:n,isModel:!0},success:function(r){t=$.parseJSON(r);$("body").data("GetPropertyModel_"+i+"_"+n,t)},timeout:5e3,complete:function(){bindModel(n,t)}}):bindModel(n,t)}function bindModel(n,t){$("#modelPost option").not(":first").remove();var i=$("#modelPost").html(),r=0;t!=undefined&&t[0]!=undefined&&$.each(t[0].SubMenu,function(t,u){n==u.ParrentPropertyId&&($("#hddProperty"+u.Group).val()==u.PropertyId?(i+='<option value="'+u.PropertyId+'" selected="selected">'+u.PropertyName+"<\/option>",GetModelRelations(u.PropertyId)):i+='<option value="'+u.PropertyId+'">'+u.PropertyName+"<\/option>",r++)});n>0&&r>0?($("#wr_modelPost input").attr("disabled",!1).removeClass("disabled"),$("#wr_modelPost a, .rq_model").show(),$("#modelPost").html(i).combobox({select:function(n,t){$("#wr_propertyId input").val("0");$("#box_property .defaultValue").trigger("click");$("#hddProperty1").val(t.item.value);GetModelRelations(t.item.value)}})):($("#modelPost").combobox({}),n>0&&$("#hddProperty1").val(n),$("#wr_modelPost input").val("").attr("disabled",!0).addClass("disabled"),$("#wr_modelPost a, .rq_model, #validGroup1").hide())}function GetPropertyUnit(n){var r=0,t,i;return $("#hddPropertyUnit").length>0&&(t=$("#hddPropertyUnit").val(),t!=""&&(i=t.split("|"),$.each(i,function(t){var u=i[t].split(";");if(n==u[0])return r=u[1],!1}))),r}function GetPropertyRelations(n){var t=null;$("body").data("GetPropertyRelations_"+n)!=null?(t=$("body").data("GetPropertyRelations_"+n),bindPropertyRelations(t)):$.ajax({type:"POST",cache:!1,url:"/HandlerWeb/SearchHandler.ashx?module=GetPropertyRelations",data:{propertyID:n},success:function(i){t=$.parseJSON(i);$("body").data("GetPropertyRelations_"+n,t)},timeout:5e3,complete:function(){bindPropertyRelations(t)}})}function bindPropertyRelations(n){if($("#box_property .disabled").removeClass("disabled"),$(n).length>0){$("#box_property ul li.lv1 span.active").each(function(){var n=$(this).attr("name").replace("rd","");$("#hddProperty"+n).val()<1&&$(this).removeClass("active")});var t,i=!0;$("#box_property .checkPost:not(.defaultValue)").each(function(){t=$(this).attr("group");$("#hddProperty"+t).val()>0&&(i=!1,$(this).addClass("active"),$("#label_group"+t).text("Có"))});$.each(n,function(n,i){singleSetDefault("#box_property ul li.single .lv1 #cb_"+i.PropertyChildId);$("#box_property ul li:not(.checkbox) .lv1 #cb_"+i.PropertyChildId).length>0&&(t=$("#box_property ul li:not(.checkbox) .lv1 #cb_"+i.PropertyChildId).attr("name").replace("rd",""),$("#hddProperty"+t).val(i.PropertyChildId));$('#box_property .checkPost[value="'+i.PropertyChildId+'"]').length>0&&($('#box_property .checkPost[value="'+i.PropertyChildId+'"]').addClass("active").parent().parent().parent().addClass("disabled"),t=$('#box_property .checkPost[value="'+i.PropertyChildId+'"]').attr("group"),$("#label_group"+t).text("Có"),$("#hddProperty"+t).val(i.PropertyChildId))});$("#box_property ul li.single").each(function(){if(!$(this).find("ul.mparent li span").hasClass("active")){var n=$(this).parent().prev().text();$(this).find(".lbProperty").text("-- Chọn "+n+" --")}})}else $("#box_property .defaultValue").trigger("click"),$("#box_property ul li.single").each(function(){var t=$(this).attr("id").replace("group_",""),n;$("#hddProperty"+t).val()<1&&(n=$(this).parent().prev().text(),$(this).find(".lbProperty").text("-- Chọn "+n+" --"))}),$("#box_property ul li .lv1 span.active").each(function(){var n=$(this).attr("name").replace("rd","");$("#hddProperty"+n).val()<1&&$(this).removeClass("active")}),$("#box_property .checkPost.active").each(function(){if($(this).hasClass("defaultValue")==!1){var n=$(this).attr("group");$("#hddProperty"+n).val()<1&&($(this).removeClass("active"),$("#label_group"+n).text("Không"))}})}function GetModelRelations(n){var t;if($("body").data("ModelRelations_"+n)!=null)t=$("body").data("ModelRelations_"+n),t!=null&&bindModelRelations(t,n);else{if($("#hddCateId_nl").val()=="97")return!1;$.ajax({type:"POST",cache:!1,url:"/HandlerWeb/SearchHandler.ashx?module=GetModelRelations",data:{propertyId:n},success:function(i){t=$.parseJSON(i);$("body").data("ModelRelations_"+n,t)},timeout:5e3,complete:function(){t!=null&&bindModelRelations(t,n)}})}}function bindModelRelations(n,t){var r,i,u;for(resetPropertyDefault(),$("#hddProperty1").val(t),r=1;r<=20;r++)i=n["PropertyId"+r],i>0&&($('#box_property .checkPost[value="'+i+'"]').length==0?(u="#box_property ul.mparent .lv1 #cb_"+i,$(u).addClass("active"),singleSetDefault("#box_property ul li.single .lv1 #cb_"+i)):($('#box_property .checkPost[value="'+i+'"]').addClass("active").parent().parent().parent().addClass("disabled"),propetyId=$('#box_property .checkPost[value="'+i+'"]').attr("group"),$("#label_group"+propetyId).text("Có")),$("#hddProperty"+r).val(i))}function resetPropertyDefault(){$("#box_property .disabled").removeClass("disabled");$("#box_property ul li.single").each(function(){var t=$(this).attr("id").replace("group_",""),n;$("#hddProperty"+t).val()<1&&(n=$(this).parent().prev().text(),$(this).find(".lbProperty").text("-- Chọn "+n+" --"),$(this).find(".mparent li .active").removeClass("active"))});$("#box_property .checkPost.active").each(function(){if($(this).hasClass("defaultValue")==!1){var n=$(this).attr("group");$("#hddProperty"+n).val()<1&&($(this).removeClass("active"),$("#label_group"+n).text("Không"))}})}function singleSetDefault(n){$(n).addClass("active");var t=$(n).parent().text();$(n).parent().parent().parent().addClass("disabled").find(".lbProperty").text(t)}function combobox_click(){$("#hsxPost").combobox({select:function(n,t){$("#wr_propertyId input").val("0");bindPropertyRelations(null);$("#wr_modelPost .custom-combobox-input").val("-- Chọn Model --");GenerateModel(t.item.value)}})}function single_click(){var n="#box_property ul li.single span.lbProperty";$(n).click(function(t){if($(".group-action.open").removeClass("open"),n="#"+$(this).parent().attr("id"),$(n).hasClass("disabled"))return!1;toggleProperty(n,t)});$("#box_property ul li.single .lv1").click(function(t){$(n+" .lv1 span").removeClass("active");$(this).find("span").addClass("active");$(n+" ul.mparent").hide();$(n).addClass("mnone");setValueProperty(this,n);t.stopPropagation()})}function checkbox_click(){var n="#box_property ul li.checkbox";$(n+" .lv1").click(function(){if($(n).hasClass("disabled"))return!1;var t=$(this).find("span").attr("name").replace("rd",""),i=$(this).find("span").attr("rel");return $(this).find("span").hasClass("active")?($("#hddProperty"+t).val(0),$(this).find("span").removeClass("active")):($("#hddProperty"+t).val(i),$(this).find("span").addClass("active")),!1})}function toggleProperty(n,t){if($(n).hasClass("disabled"))return!1;$(n).hasClass("mnone")?($(n+" ul.mparent").show(),$(n).toggleClass("mnone")):($(n+" ul.mparent").hide(),$(n).toggleClass("mnone"));t.stopPropagation();$(document).mouseup(function(t){var i=$(n);i.is(t.target)||i.has(t.target).length!==0||($(n+" ul.mparent").hide(),$(n).addClass("mnone"))})}function setValueProperty(n,t){var u=$(n).text(),i,r;return $(t+" .lbProperty").text(u),i=$(n).find("span").attr("name").replace("rd",""),r=$(n).find("span").attr("rel"),$("#hddProperty"+i).val(r),!1}function showMenuProperty(){var n="#box_property ul li.wrsub",t;$(n+" .lv1 span:not(.other)").hasClass("active")&&($(n+" .lv1").not(".active").hide(),$(n+" .lv1.active ul").show(),t=$(n+" .lv1 ul li.lv2 span.active").attr("rel"),GetModelRelations(t))}function GetPriceName(n){var r="",t,i;if(n=n.replace(/\./g,""),n=parseInt(n)*1e3,n>=1e9){var t=Math.floor(n/1e9)+" tỷ",i=Math.round(n%1e9,0)/1e6+"",u=Math.round(n%1e6,0)/1e3+"";r=i=="0"?t:t+" "+Math.floor(i)+" triệu";u!="0"&&(r+=" "+Math.round(u)+" nghìn")}else n>=1e6&&(t=Math.floor(n/1e6)+" triệu",i=Math.round(n%1e6,0)/1e3+"",r+=i=="0"?t:t+" "+Math.round(i)+" nghìn");return r}function check_phone(n){return/\b0[1-9][0-9]{8,12}\b/.test(n)}function check_regdate(n){return/\b(19|20)\d{2}\b/.test(n)}function handleAI_input(){$("#Mobile, #strPrice").keydown(function(n){var t=n.which?n.which:n.keyCode;return t==45&&($(this).val()||$(this).val(0)),t!=46&&t!=8&&t!=37&&t!=39&&t!=9&&t>31&&(t<48||t>57)&&(t<96||t>105)?!1:void 0});translatePrice();$("input#strPrice").on("focusout",function(){translatePrice()}).on("keyup",function(){translatePrice()}).on("input propertychange",function(){translatePrice()})}function InputMaxLength(n,t,i,r){var u=this;this.maxlen=i;this.minlen=r;this.el=$("#"+n);this.counter=$("#"+t);this.el.bind("keyup paste forcusout",function(n){u.count(n)});this.count()}function bindLen(){var n=new InputMaxLength("Description","countDesc",2e3,2),t=new InputMaxLength("Title","countTitle",100,2);return!0}function DocSo3ChuSo(n){var u,t,r,i="";if(u=parseInt(n/100),t=parseInt(n%100/10),r=n%10,u==0&&t==0&&r==0)return"";u!=0&&(i+=ChuSo[u]+" trăm ",t==0&&r!=0&&(i+=" linh "));t!=0&&t!=1&&(i+=ChuSo[t]+" mươi",t==0&&r!=0&&(i=i+" linh "));t==1&&(i+=" mười ");switch(r){case 1:i+=t!=0&&t!=1?" mốt ":ChuSo[r];break;case 5:i+=t==0?ChuSo[r]:" năm ";break;default:r!=0&&(i+=ChuSo[r])}return i}function DocTienBangChu(n){var e=0,u=0,r=0,i="",f="",t=[];if(n<0||n==0)return"";if(r=n>0?n:-n,n>8999999999999999)return"Số quá lớn!";for(t[5]=Math.floor(r/1e15),isNaN(t[5])&&(t[5]="0"),r=r-parseFloat(t[5].toString())*1e15,t[4]=Math.floor(r/1e12),isNaN(t[4])&&(t[4]="0"),r=r-parseFloat(t[4].toString())*1e12,t[3]=Math.floor(r/1e9),isNaN(t[3])&&(t[3]="0"),r=r-parseFloat(t[3].toString())*1e9,t[2]=parseInt(r/1e6),isNaN(t[2])&&(t[2]="0"),t[1]=parseInt(r%1e6/1e3),isNaN(t[1])&&(t[1]="0"),t[0]=parseInt(r%1e3),isNaN(t[0])&&(t[0]="0"),e=t[5]>0?5:t[4]>0?4:t[3]>0?3:t[2]>0?2:t[1]>0?1:0,u=e;u>=0;u--)f=DocSo3ChuSo(t[u]),i+=f,t[u]>0&&(i+=Tien[u]),u>0&&f.length>0&&(i+=",");return i.substring(i.length-1)==","&&(i=i.substring(0,i.length-1)),i=i.substring(1,2).toUpperCase()+i.substring(2),i=$.trim(i),i+" đồng"}function replaceHtml(n){var t=new RegExp("<.*?>","g");return n.replace(t,"")}function checkHtml(n){var t=new RegExp("<.*?>"),i=t.exec(n);return i==null?!1:!0}function clear_form_elements(n){$("input:text","#postForm").val("");$("textarea","#postForm").val("");var t=n.getElementsByTagName("select");for(i=0;i<t.length;i++)if(t[i].type=="select-one")t[i].selectedIndex=0;else for(j=0;j<t[i].options.length;j++)t[i].options[j].selected=!1}function translatePrice(){var n=validateNumber(),t="";n.length>3&&(t=GetPriceName(n),$("#tprice").text(t));t==""&&$("#tprice").text((n==0?0:n)+" nghìn đồng")}function validateNumber(){var u="",n,i,r,t;if($("#strPrice").length>0&&$("#strPrice").val()!=""&&(n=$("input#strPrice").val(),i=n.length,i>0&&!(n==="")&&n!=null))for(i=n.length,r=0;r<i;r++)t=n.charAt(r),t>="0"&&t<="9"&&!(t=="")&&(u=u+t);return u}var lblCatePost="#lblCatePost",hddCateId_nl="#hddCateId_nl",dataProperty,ChuSo,Tien,origLoad;$(function(){$("#div_area_nl > ul > li > a").on("click",function(){$("#div_area_nl > ul > li > a").removeClass("active");$(this).addClass("active");$("#hddAreaId_nl").hasClass("hddAreaId_up")?$("#hddAreaId_nl").val($(this).attr("id")=="City_All"?"0":$(this).attr("id").replace("City_","")):$("#hddAreaId_nl").val($(this).attr("id")=="City_All"?"City_0":$(this).attr("id"));$("#div_area_nl #label_area").text($(this).text());$("#div_area_nl").removeClass("open")});$("#div_cate_nl .group-category > li > a").on("click",function(){var n=$(this);$("#div_cate_nl .group-category > li > a").not("#"+n.attr("id")).next().slideUp().parent().removeClass("expand");n.next().slideToggle(function(){n.parent().toggleClass("expand");n.next().removeAttr("style")})});$("body").on("click",".grp_property .checkbox .label",function(){$(this).prev().trigger("click")});$("body").on("click",".grp_property .group-category > li > a.checkPost",function(){$(this).parents(".group-category").find(".active").removeClass("active");$(this).addClass("active");$("#hddProperty"+$(this).attr("group")).val($(this).attr("value"));$("#label_group"+$(this).attr("group")).text($(this).text());$("#group"+$(this).attr("group")).removeClass("open")});parseInt($("#hddCateId_nl").val())<=0&&$(".wrbox_property").hide();$("#div_cate_nl .sub-category > li > a").on("click",function(){var n=$(this).attr("id");parseInt(n)>0?($("#wr_propertyId input").val("0"),GetPropertyGroup(n),$("#hddOjectPrice").length>0&&$.ajax({type:"POST",cache:!1,url:"/HandlerWeb/SearchHandler.ashx?module=GetPriceGroup",data:{cateId:n},success:function(n){$("#hddOjectPrice").val(n);$("#hddFrom").val("0");$("#from_price").parent().html("");$("#hddTo").val("0");$("#to_price").parent().html("");GetPriceGroup2()}})):$(".wrbox_property").hide();$("#div_cate_nl .sub-category > li > a").removeClass("active");$(this).addClass("active");$("#hddCateId_nl").val($(this).attr("id"));$("#div_cate_nl #label_cate").text($(this).text());$("#div_cate_nl").removeClass("open");setTimeout(function(){n=="97"&&$(".titlebox.post_model_1").length&&$(".titlebox.post_model_1").html("Series <span class='request rq_model'> *<\/span>")},500)});loadData();handleAI_input();$("input#Title, textarea#Description").bind("input propertychange",function(){bindLen()})});dataProperty=null;$.fn.pricemask=function(){$(this).keyup(function(){var n=$(this).val().replace(/\./g,"").replace(/,/g,"");$(this).val(n).formatCurrency({roundToDecimalPlace:-1,symbol:""});n=$(this).val().replace(/,/g,".");$(this).val(n)})};InputMaxLength.prototype={count:function(n){var t=this.el.val().length,i;if(/msie/.test(navigator.userAgent.toLowerCase())||/opera/.test(navigator.userAgent.toLowerCase())){i=n?n.type:null;switch(i){case"keyup":t>this.maxlen&&(this.el.val(this.el.val().substr(0,this.maxlen)),t=this.el.val().length);break;case"paste":t>this.maxlen&&(this.el.val(this.el.val().substr(0,this.maxlen)),t=this.el.val().length);break;case"forcusout":t>this.maxlen&&(this.el.val(this.el.val().substr(0,this.maxlen)),t=this.el.val().length)}}return t>this.minlen&&t<=this.maxlen&&$.trim(this.el.val()).indexOf(" ")>0?this.counter.removeClass().addClass("normal_counter"):this.counter.removeClass().addClass("min_counter"),this.counter.text(t+"/"+this.maxlen),!0}};ChuSo=[" không "," một "," hai "," ba "," bốn "," năm "," sáu "," bảy "," tám "," chín "];Tien=[""," nghìn"," triệu"," tỷ"," nghìn tỷ"," triểu tỷ"];origLoad=1,function(n){n.widget("custom.combobox",{_create:function(){this.wrapper=n("<span>").addClass("custom-combobox").insertAfter(this.element);this.element.hide();this._createAutocomplete();this._createShowAllButton()},_createAutocomplete:function(){var i=this.element.children(":selected"),r=i.val()?i.text():"",t;this.input=n("<input>").appendTo(this.wrapper).val(r).attr("title","").addClass("custom-combobox-input ui-widget ui-widget-content ui-state-default ui-corner-left").autocomplete({delay:0,minLength:0,source:n.proxy(this,"_source")});t="";this.input.focus(function(){t=n(this).val();(t=="-- Chọn hãng sản xuất --"||t=="-- Chọn Model --")&&(n(this).val(""),n(this).autocomplete("search",""))});this.input.blur(function(){n(this).val()==""&&n(this).val(t)});this._on(this.input,{autocompleteselect:function(n,t){t.item.option.selected=!0;this._trigger("select",n,{item:t.item.option})},autocompletechange:"_removeIfInvalid"})},_createShowAllButton:function(){var t=this.input,i=!1;n("<a>").attr("tabIndex",-1).appendTo(this.wrapper).button({icons:{primary:"ui-icon-triangle-1-s"},text:!1}).removeClass("ui-corner-all").addClass("custom-combobox-toggle ui-corner-right icon-select").mousedown(function(){i=t.autocomplete("widget").is(":visible")}).click(function(){(t.focus(),i)||t.autocomplete("search","")})},_source:function(t,i){var r=new RegExp(n.ui.autocomplete.escapeRegex(t.term),"i");i(this.element.children("option").map(function(){var i=n(this).text();if(this.value&&(!t.term||r.test(i)))return{label:i,value:i,option:this}}))},_removeIfInvalid:function(t,i){var u,r;if(!i.item){var f=this.input.val(),o=f.toLowerCase(),e=!1;(this.element.children("option").each(function(){if(n(this).text().toLowerCase()===o)return this.selected=e=!0,!1}),e)||(u="",r=0,n("#wr_propertyId input").val("0"),f!=""&&(this.input.parent().prev().attr("id")=="hsxPost"?(n("#hsxPost option").each(function(){if(n(this).html().indexOf("khác")>0){n(this).attr("selected","selected");u=n(this).html();r=n(this).val();n("#hddProperty1").val(r);return}}),n("#hddProperty1").val()==0&&n(this).val("-- Chọn hãng sản xuất --"),n("#wr_modelPost input").val("").attr("disabled",!0).addClass("disabled"),n("#wr_modelPost a, .rq_model, #validGroup1").hide()):(n("#modelPost option").each(function(){if(n(this).html().indexOf("khác")>0){n(this).attr("selected","selected");u=n(this).html();r=n(this).val();n("#hddProperty1").val(r);return}}),n("#hddProperty1").val()==0&&n(this).val("-- Chọn Model --")),this.input.val(u)),GetModelRelations(r),this.input.data("ui-autocomplete").term="")}},_destroy:function(){this.wrapper.remove();this.element.show()}})}(jQuery)